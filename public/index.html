<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Debirun Pop — Dustarian Mission</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css">
  
  <meta name="theme-color" content="#0b1130">
</head>
<body>
  <!-- พื้นหลังเอฟเฟกต์เดิม (ดาว/ดาวตก) -->
  <div class="cosmos" aria-hidden="true">
    <div class="meteor m1"></div>
    <div class="meteor m2"></div>
    <div class="meteor m3"></div>
  </div>

  <!-- NEW: ชั้นพื้นหลังอวกาศที่ดึงมาจากออนไลน์ + เครดิตมุมขวาล่าง -->
  <div id="spaceRemote" class="space-remote" aria-hidden="true"></div>
  <small id="bgCredit" class="bg-credit" hidden>
    Background: <a class="link-clean" href="#" target="_blank" rel="noopener">—</a>
  </small>
  <!-- /NEW -->

  <section class="landing login-container" id="loginContainer">
    <div class="landing-card">
      
      <div class="brand">
        <h1 class="logo">DEBIRUN <span>POP</span></h1>
        <p class="tagline">พลังของเจ้า… จะถูกใช้ในภารกิจ “ยึดครองจักรวาล”!</p>
      </div>

      <figure class="hero">
        <img src="พื้นหลังใส-1.png" alt="Debirun">
      </figure>

      <div class="join">
        <label for="nameInput">ลงนามหน่วยพิเศษดัสทีเรี่ยน</label>
        <div class="join-row">
          <input type="text" id="nameInput" placeholder="ENTER AGENT NAME" maxlength="15" autocomplete="off" />
          <button id="startButton">รับภารกิจ</button>
        </div>
      </div>

      <div class="socials">
        <span>ติดตามเดบิรุน:</span>
        <a class="link-clean" href="https://youtube.com/@debirunworldend?si=CWReY3AJ_qvl6nfs" target="_blank" rel="noopener">YouTube</a>
        <a class="link-clean" href="https://twitter.com/DebirunWorldEnd" target="_blank" rel="noopener">Twitter/X</a>
        <a class="link-clean" href="https://facebook.com/DebirunWorldEnd" target="_blank" rel="noopener">Facebook</a>
        <a class="link-clean" href="https://tiktok.com/@debirunworldend" target="_blank" rel="noopener">TikTok</a>
      </div>

      <!-- ปรับให้ “ขอบคุณ” เด่นแบบไม่สะดุด (จะสไตล์ใน CSS) -->
      <footer class="credits credits-ribbon">
        <strong>ขอบคุณ</strong>
        <span>ภาพประกอบ: <a class="link-clean" href="https://twitter.com/6nnae6" target="_blank" rel="noopener">@6nnae6</a></span>
        <span>เสียง : Debirun Ch. Pixela-World-End</span>
      </footer>
    </div>
  </section>

  <section class="game-container" id="gameContainer" style="display:none;">
    <header class="game-header">
      <div class="player-info">Dustarian: <span id="playerName"></span></div>
      <div class="game-actions">
        <button id="howToPlayButton" class="action-button" aria-label="คู่มือการเล่น">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        </button>
        <button id="leaderboardButton" class="action-button" aria-label="ตารางคะแนน">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17h4v-2.34"/><path d="M8 19h8"/><path d="M12 17.5V14l-3-3 4-3 4 3-3 3"/><path d="M10 9h.01"/><path d="M14 9h.01"/></svg>
        </button>
        <!-- NEW: ปุ่มตั้งค่าเสียง -->
        <button id="settingsButton" class="action-button" aria-label="ตั้งค่าเสียง">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 5 15.4a1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.6a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9c.27.5.4 1.06.4 1.6s-.13 1.1-.4 1.6Z"/></svg>
        </button>
        <!-- /NEW -->
      </div>
      <div class="score">POWER: <span id="score">0</span></div>
    </header>

    <main class="main-game">
      <img id="debirunImage" src="พื้นหลังใส-1.png" alt="Debirun" draggable="false"/>
    </main>

    <!-- NEW: เพิ่ม data-* สำหรับสเกลความยาก (Lv.1 = base, Lv.ถัดไป = goal * growth^level) -->
    <section
      class="coop"
      id="coop"
      data-goal-base="1000"
      data-goal-growth="1.25"
    >
      <h2>DUSTARIAN MISSION</h2>
      <div class="bar"><div class="fill" id="coopFill" style="width:0%"></div></div>
      <div class="coop-text">
        <span id="coopText">0 / 1,000 • Lv.1</span>
        <small>ทุกการคลิก คือการส่งมอบพลังให้ เดบิรุน</small>
      </div>
    </section>
    <!-- /NEW -->
  </section>

  <!-- Modals -->
  <div id="howToPlayModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <button class="modal-close" id="closeHowToPlay" aria-label="ปิด">&times;</button>
      <h2>MISSION BRIEFING</h2>
      <div class="modal-body">
        <h3>วิธีเล่น</h3>
        <ol>
          <li>พิมพ์ชื่อ แล้วกด <em>รับภารกิจ</em></li>
          <li>แตะตัวเดบิรุนเพื่อส่งพลัง <strong>POWER</strong> จะเพิ่มขึ้น</li>
          <li>พลังรวมของดัสทีเรี่ยนทั้งหมดจะแสดงใน <strong>Dustarian Mission</strong></li>
          <li>กลับมาเล่นด้วยชื่อเดิมได้ คะแนนส่วนตัวจะถูกโหลดกลับมา</li>
        </ol>
        <p>พลังของเจ้า จะเป็นส่วนหนึ่งของการยึดครองจักรวาลนี้!</p>
      </div>
    </div>
  </div>

  <div id="leaderboardModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <button class="modal-close" id="closeLeaderboard" aria-label="ปิด">&times;</button>
      <h2>TOP Players RANKING</h2>
      <div class="modal-body">
        <ul id="leaderboard-list"></ul>
      </div>
    </div>
  </div>

  <!-- NEW: Settings Modal -->
  <div id="settingsModal" class="modal-overlay" style="display:none;">
    <div class="modal-content">
      <button class="modal-close" id="closeSettings" aria-label="ปิด">&times;</button>
      <h2>ตั้งค่าเสียง</h2>
      <div class="modal-body settings-body">
        <div class="settings-row">
          <span>เปิดเสียงทั้งหมด</span>
          <label>
            <input id="toggleAll" type="checkbox" class="toggle">
            <span class="switch"></span>
          </label>
        </div>
        <hr class="sep"/>
        <div class="settings-row">
          <span>เสียง Pop</span>
          <label>
            <input id="togglePop" type="checkbox" class="toggle">
            <span class="switch"></span>
          </label>
        </div>
        <div class="settings-row">
          <span>เสียงโบนัส/รัว</span>
          <label>
            <input id="toggleRapid" type="checkbox" class="toggle">
            <span class="switch"></span>
          </label>
        </div>
        <div class="settings-row">
          <span>เสียงเชิญชวน (Idle)</span>
          <label>
            <input id="toggleIdle" type="checkbox" class="toggle">
            <span class="switch"></span>
          </label>
        </div>
        <div class="settings-row vol">
          <span>ระดับเสียงรวม</span>
          <div class="volume-wrap">
            <input id="volumeSlider" type="range" min="0" max="100" step="1" class="volume">
            <output id="volumeValue">100%</output>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- /NEW -->

  <!-- NEW: ตัวโหลด “พื้นหลังอวกาศออนไลน์” แบบสุ่มรายวัน + เครดิต -->
  <script>
    // แหล่งภาพอวกาศสาธารณะ (NASA/ESA/Unsplash – ใช้ได้ฟรี, มีเครดิต)
    // หมายเหตุ: ถ้าต้องการเพิ่ม/เปลี่ยนภาพ แก้ลิสต์นี้ได้เลย
    window.SPACE_BG_LIST = [
      { url: "https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?q=80&w=1920&auto=format&fit=crop",
        by: "Unsplash • Greg Rakozy", href: "https://unsplash.com/photos/Q1p7bh3SHj8" },
      { url: "https://images.unsplash.com/photo-1447433819943-74a20887a81e?q=80&w=1920&auto=format&fit=crop",
        by: "Unsplash • Jeremy Thomas", href: "https://unsplash.com/photos/E0AHdsENmDg" },
      { url: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1920&auto=format&fit=crop",
        by: "Unsplash • NASA", href: "https://unsplash.com/photos/NBVLx3jY-2A" },
      { url: "https://images.unsplash.com/photo-1473929731735-78f2a5133a5f?q=80&w=1920&auto=format&fit=crop",
        by: "Unsplash • Johnson Johnson", href: "https://unsplash.com/photos/GR0a9h9zE78" }
    ];

    (function setRemoteSpaceBackground(){
      const host = document.getElementById("spaceRemote");
      const credit = document.getElementById("bgCredit");
      const list = window.SPACE_BG_LIST || [];
      if (!host || !list.length) return;

      // สุ่ม “รายวัน” จากวันที่ (ให้ทุกคนเห็นภาพเดียวกันในวันนั้น)
      const seedStr = new Date().toISOString().slice(0,10);
      let hash = 0; for (let i=0;i<seedStr.length;i++) hash = (hash*31 + seedStr.charCodeAt(i)) >>> 0;
      const pick = list[hash % list.length];

      host.style.backgroundImage = `url('${pick.url}')`;
      host.style.opacity = "0.52"; // ทำให้พื้นหลังชัดขึ้นเล็กน้อย

      if (credit) {
        const a = credit.querySelector("a");
        a.textContent = pick.by;
        a.href = pick.href || "#";
        credit.hidden = false;
      }
    })();
  </script>
  <!-- /NEW -->

  <script src="script.js" defer></script>
</body>
</html>
